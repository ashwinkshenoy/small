"use strict";function stockControllerFunc(o,t){t({method:"GET",url:"data.json",dataType:"json"}).then(function(t){o.stocks=t.data.price,o.weight=t.data.eps,o.historical=t.data.historical,o.limit=8,o.currentPage=1,o.totalItems=Object.keys(o.stocks).length,o.entryLimit=8,o.noOfPages=Math.ceil(o.totalItems/o.entryLimit)}),o.portfolio=[],o.stocksCount=0;var r=0;o.netWorth=r,o.addFolio=function(t,r){if(!function(o,t){var r;for(r=0;r<t.length;r++)if(t[r].name===o)return!0;return!1}(t,o.portfolio)){var e=o.weight[t],i={};i.name=t,i.price=r,i.eps=e,i.historical=o.historical[t],i.count=1,o.portfolio.push(i),o.netTotal()}o.stocksCount=o.portfolio.length,o.chart()},o.removeFolio=function(t,r){for(var e=0;e<o.portfolio.length;e++)o.portfolio[e].name===t&&o.portfolio.splice(e,1);o.stocksCount=o.portfolio.length,o.netTotal()},o.shareCalculate=function(t,r){for(var e=0;e<o.portfolio.length;e++)o.portfolio[e].name===t&&(o.portfolio[e].count=r,0==r&&o.portfolio.splice(e,1));o.stocksCount=o.portfolio.length,o.netTotal()},o.netTotal=function(){for(var t=[],e=0;e<o.portfolio.length;e++)t[e]=o.portfolio[e].price*o.portfolio[e].count;r=t.reduce(function(o,t){return o+Number(t)},0),o.netWorth=r.toFixed(2),o.weightage()},o.weightage=function(){for(var t=[],r=0;r<o.portfolio.length;r++)t[r]=parseInt(o.portfolio[r].price*o.portfolio[r].count),o.portfolio[r].weight=parseFloat((t[r]/o.netWorth).toFixed(2))},o.pe=function(){for(var t,r=[],e=0;e<o.portfolio.length;e++)r[e]=o.portfolio[e].eps*o.portfolio[e].count;return t=r.reduce(function(o,t){return o+Number(t)},0),isNaN(o.netWorth/t)?0:(o.netWorth/t).toFixed(2)};o.chart=function(){for(var t=0;t<o.portfolio.length;t++)for(var r=0;r<o.portfolio[t].historical.point.length;r++){var e=new Date(o.portfolio[t].historical.point[r].date);o.portfolio[t].historical.point[r].date=e.getDate(),o.portfolio[t].historical.point[r].price=o.portfolio[t].historical.point[r].price*o.portfolio[t].count}console.log(o.portfolio);var i=o.portfolio.length-1;o.$broadcast("amCharts.updateData",o.portfolio[i].historical.point,"myFirstChart")},o.amChartOptions={data:[{date:24,price:23.5},{date:1,price:26.2},{date:8,price:30.1},{date:19,price:29.5},{date:21,price:24.6}],type:"serial",legend:{enabled:!1},chartScrollbar:{enabled:!1},categoryAxis:{gridPosition:"end",parseDates:!1},fontSize:12,valueAxes:[{position:"bottom",title:"Value"}],theme:"light",marginRight:30,marginTop:10,graphs:[{fillAlpha:1,type:"smoothedLine",lineAlpha:1,lineThickness:2,bullet:"round",bulletSize:5}]}}var app=angular.module("app",["angularUtils.directives.dirPagination","amChartsDirective"]).controller("stockController",["$scope","$http",stockControllerFunc]);